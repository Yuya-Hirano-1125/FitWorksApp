<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${trainingTitle}"></title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" th:href="@{/css/base.css}">
    <style>
        .session-page .main-container { max-width: 650px; padding: 30px; }
        .program-card {
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            background: #2a2a2a;
            box-shadow: 0 0 15px rgba(0, 230, 118, 0.4);
            text-align: center;
        }
        .program-card h2 { color: var(--primary-color); font-size: 28px; margin-top: 0; }
        .program-card p.exercise-type {
            color: #ccc;
            font-size: 14px;
            margin-bottom: 20px;
        }
        .exercise-info-label { color:#ccc; font-size:14px; margin-top:10px; }
        .exercise-info-value { color:white; font-size:18px; font-weight:700; margin-bottom:15px; }

        .program-list { list-style: none; padding: 0; text-align: left; }
        .program-list li { 
            padding: 10px 0; 
            border-bottom: 1px dashed #444; 
            color: #ddd; 
            font-weight: 500;
        }
        .control-buttons { margin-top: 40px; display: flex; flex-direction: column; gap: 15px; }
        .control-buttons a, .control-buttons button { flex-grow: 1; }
        
        .log-placeholder {
            background-color: #1e1e1e;
            border: 1px dashed #555;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            color: #888;
        }
        
        /* === TIMER STYLES === */
        .timer-section {
            background-color: #1a1a1a;
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
            border: 1px solid #333;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
            margin-bottom: 30px;
        }
        .timer-display {
            font-size: 48px;
            font-weight: 800;
            letter-spacing: 3px;
            color: #fff;
            margin: 10px 0 20px;
            font-family: 'Poppins', monospace;
        }
        .timer-interval {
            color: var(--primary-color);
        }
        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .timer-controls button {
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            border: none;
            flex-grow: 1;
        }
        .timer-button-primary {
            background-color: var(--primary-color);
            color: #1a1a1a;
        }
        .timer-button-secondary {
            background-color: #444;
            color: #ddd;
        }
        .timer-button-tertiary {
            background-color: #555;
            color: #fff;
            font-size: 14px;
            padding: 8px 15px;
        }
        .timer-controls button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        .timer-settings {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
            margin-bottom: 15px;
            color: #ddd;
        }
        .timer-settings input {
            background-color: #333;
            color: #fff;
            border: 1px solid #555;
            border-radius: 5px;
            padding: 5px;
            text-align: center;
            font-size: 16px;
        }

        /* === RECORD FORM STYLES === */
        .record-form-container {
            background-color: #1e1e1e;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: left;
        }
        .form-label {
            display: block;
            color: #aaa;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        .form-group {
            flex: 1;
        }
        .form-input {
            width: 100%;
            padding: 12px;
            background-color: #333;
            border: 1px solid #555;
            border-radius: 8px;
            color: white;
            font-size: 1.1rem;
            text-align: center;
        }
        .form-input:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        .unit {
            color: #888;
            font-size: 0.8rem;
            text-align: center;
            display: block;
            margin-top: 3px;
        }
        .btn-finish {
            width: 100%;
            padding: 15px;
            background-color: var(--primary-color);
            color: #1a1a1a;
            font-weight: 800;
            font-size: 1.1rem;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            transition: transform 0.2s;
            display: block;
            text-decoration: none;
            text-align: center;
            margin-top: 20px;
        }
        .btn-finish:hover {
            transform: scale(1.02);
            background-color: #00c853;
        }
    </style>
</head>
<body class="session-page">
<div class="main-container">
    
    <h1 th:text="${trainingTitle}"><i class="fa-solid fa-bolt-lightning header-icon"></i>ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹</h1>

    <div class="program-card">
        <!-- ç¨®ç›®å -->
        <h2 th:text="${selectedExercise}">ç¨®ç›®å</h2>

        <!-- ãƒ•ãƒªãƒ¼ã‚¦ã‚§ã‚¤ãƒˆ / æœ‰é…¸ç´  / AI -->
        <p class="exercise-type" th:if="${trainingType == 'free-weight'}"><i class="fa-solid fa-weight-hanging"></i> ãƒ•ãƒªãƒ¼ã‚¦ã‚§ã‚¤ãƒˆ</p>
        <p class="exercise-type" th:if="${trainingType == 'cardio'}"><i class="fa-solid fa-running"></i> æœ‰é…¸ç´ é‹å‹•</p>
        <p class="exercise-type" th:if="${trainingType == 'ai-suggested'}"><i class="fa-solid fa-star"></i> AIãŠã™ã™ã‚ãƒ—ãƒ­ã‚°ãƒ©ãƒ </p>

        <!-- â­è¿½åŠ ï¼šé›ãˆãŸã„éƒ¨ä½ã®è¡¨ç¤º -->
        <p class="exercise-info-label">é›ãˆã‚‹éƒ¨ä½</p>
        <p class="exercise-info-value" th:text="${selectedPart}">èƒ¸</p>

        <!-- éš ã—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ä¿å­˜ -->
        <input type="hidden" id="selectedPart" th:value="${selectedPart}">
        <input type="hidden" id="selectedExercise" th:value="${selectedExercise}">

        <!-- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã‚¿ã‚¤ãƒãƒ¼ -->
        <div class="interval-container">
            <h3 style="color: var(--primary-color); margin-bottom: 5px; margin-top: 20px;">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã‚¿ã‚¤ãƒãƒ¼</h3>
            <div id="interval-display" class="timer-display timer-interval">01:00</div>
            <div class="timer-settings">
                <input type="number" id="interval-minutes" value="1" min="0" max="59" style="width: 50px;"> åˆ†
                <input type="number" id="interval-seconds" value="0" min="0" max="59" style="width: 50px;"> ç§’
                <button id="interval-set" class="button timer-button-tertiary"><i class="fa-solid fa-clock"></i> è¨­å®š</button>
            </div>
            <div class="timer-controls">
                <button id="interval-start-pause" class="button timer-button-primary"><i class="fa-solid fa-play"></i> é–‹å§‹</button>
                <button id="interval-reset" class="button timer-button-secondary"><i class="fa-solid fa-rotate-left"></i> ãƒªã‚»ãƒƒãƒˆ</button>
            </div>
        </div>
    </div>

    <!-- ======= ãƒ•ãƒªãƒ¼ã‚¦ã‚§ã‚¤ãƒˆ ======= -->
    <div th:if="${trainingType == 'free-weight'}" class="record-form-container">
        <h3 style="color:white; margin-bottom:15px; border-bottom:1px solid #444; padding-bottom:10px;">
            <i class="fa-solid fa-pen-to-square"></i> å®Ÿç¸¾ã‚’è¨˜éŒ²
        </h3>

        <form th:action="@{/training-log/save}" method="post">
            <input type="hidden" name="recordDate" th:value="${today}">
            <input type="hidden" name="type" value="WEIGHT">

            <!-- â­ å‰ç”»é¢æƒ…å ±ã‚’ä¿å­˜ -->
            <input type="hidden" name="musclePart" th:value="${selectedPart}">
            <input type="hidden" name="exerciseName" th:value="${selectedExercise}">

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">é‡é‡</label>
                    <input type="number" name="weight" class="form-input" step="0.5" placeholder="0" required>
                    <span class="unit">kg</span>
                </div>
                <div class="form-group">
                    <label class="form-label">å›æ•°</label>
                    <input type="number" name="reps" class="form-input" placeholder="0" required>
                    <span class="unit">å› (Reps)</span>
                </div>
                <div class="form-group">
                    <label class="form-label">ã‚»ãƒƒãƒˆæ•°</label>
                    <input type="number" name="sets" class="form-input" value="1" required>
                    <span class="unit">ã‚»ãƒƒãƒˆ</span>
                </div>
            </div>

            <button type="submit" class="btn-finish">
                è¨˜éŒ²ã—ã¦çµ‚äº† <i class="fa-solid fa-check"></i>
            </button>
        </form>
    </div>

    <!-- ======= æœ‰é…¸ç´  ======= -->
    <div th:if="${trainingType == 'cardio'}" class="record-form-container">
        <h3 style="color:white; margin-bottom:15px; border-bottom:1px solid #444; padding-bottom:10px;">
            <i class="fa-solid fa-pen-to-square"></i> å®Ÿç¸¾ã‚’è¨˜éŒ²
        </h3>

        <form th:action="@{/training-log/save}" method="post">
            <input type="hidden" name="recordDate" th:value="${today}">
            <input type="hidden" name="type" value="CARDIO">

            <!-- â­ è¡¨ç¤º -->
            <input type="hidden" name="musclePart" th:value="${selectedPart}">
            <input type="hidden" name="cardioType" th:value="${selectedExercise}">

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">æ™‚é–“</label>
                    <input type="number" name="durationMinutes" class="form-input" placeholder="0" required>
                    <span class="unit">åˆ† (Minutes)</span>
                </div>
                <div class="form-group">
                    <label class="form-label">è·é›¢</label>
                    <input type="number" name="distanceKm" class="form-input" step="0.1" placeholder="0.0">
                    <span class="unit">km (ä»»æ„)</span>
                </div>
            </div>

            <button type="submit" class="btn-finish">
                è¨˜éŒ²ã—ã¦çµ‚äº† <i class="fa-solid fa-check"></i>
            </button>
        </form>
    </div>

    <!-- ======= AIãƒ—ãƒ­ã‚°ãƒ©ãƒ  ======= -->
    <div th:if="${trainingType == 'ai-suggested'}">
        <div class="log-placeholder" style="border-color: var(--ai-accent-color); box-shadow: 0 0 15px rgba(0, 255, 255, 0.4);">
            <p style="color: var(--ai-accent-color); font-weight: 600;">FitBotã®ææ¡ˆå†…å®¹:</p>
            <ul class="program-list">
                <li><i class="fa-solid fa-circle-right" style="color:#00c8c8;"></i> 1. ç¨®ç›®A: 4ã‚»ãƒƒãƒˆ x 10å› (70kg)</li>
                <li><i class="fa-solid fa-circle-right" style="color:#00c8c8;"></i> 2. ç¨®ç›®B: 3ã‚»ãƒƒãƒˆ x 12å› (20kg)</li>
                <li><i class="fa-solid fa-circle-right" style="color:#00c8c8;"></i> 3. ç¨®ç›®C: 3ã‚»ãƒƒãƒˆ x 15å›</li>
            </ul>

            <p style="margin-top: 20px; color: var(--primary-color);">ç›®æ¨™æ™‚é–“: 45åˆ† / ä¼‘æ†©æ™‚é–“: 60ç§’</p>
        </div>

        <div class="control-buttons">
            <a th:href="@{/training-log}" class="button primary">ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº† (ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«æˆ»ã‚‹)</a>
        </div>
    </div>

    <div class="control-buttons" style="margin-top: 40px;">
        <a th:href="@{/training}" class="button secondary">
            ä¸­æ–­ã—ã¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼é¸æŠã«æˆ»ã‚‹ <i class="fa-solid fa-arrow-rotate-left"></i>
        </a>
    </div>

    <div class="button-container" style="margin-top: 20px;">
        <a th:href="@{/ai-coach}" class="button ai-coach-button">
            ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å†…å®¹ã‚’AIã‚³ãƒ¼ãƒã«ç›¸è«‡ ğŸ¤–
        </a>
    </div>

</div>
</body>
</html>
