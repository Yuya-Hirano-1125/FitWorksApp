<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org"> 
	<head>
	    <meta charset="UTF-8">
	    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	    <title>èƒŒæ™¯ä¸€è¦§ | FitWorks</title>
	    
	    <!-- Google Fonts -->
	    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700;800;900&family=Noto+Sans+JP:wght@400;700;800&display=swap" rel="stylesheet">
	    
	    <!-- Tailwind -->
	    <script src="https://cdn.tailwindcss.com"></script>
	    
	    <!-- ã‚ãªãŸã®CSS -->
	    <link rel="stylesheet" th:href="@{/css/characters/Backgrounds.css}">
	    
	    <!-- â˜… Font Awesome èª­ã¿è¾¼ã¿ï¼ˆã“ã‚Œã‚’è¿½åŠ ï¼‰ -->
	    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

	    <style>
	        .card-name-overlay { pointer-events: none; }
	        .background-card.selected {
	            border: 3px solid var(--primary-color);
	            box-shadow: 0 0 10px var(--primary-color);
	        }
	        .status-text { color: var(--primary-color); font-weight: bold; }
	        .select-button {
	            padding: 0.5rem 1rem;
	            border-radius: 0.5rem;
	            background: var(--primary-color);
	            color: #fff;
	            font-weight: 700;
	            transition: opacity .2s ease;
	        }
	        .select-button:hover { opacity: .9; }

	        /* â˜… è¿½åŠ : ãƒ­ãƒƒã‚¯ä¸­ã§ã‚‚è§£æ”¾ãƒœã‚¿ãƒ³ã¯ã‚¯ãƒªãƒƒã‚¯å¯èƒ½ã«ã™ã‚‹ */
	        .background-card.locked {
	            opacity: 0.6;
	            pointer-events: none; /* å…¨ä½“ã¯ã‚¯ãƒªãƒƒã‚¯ä¸å¯ */
	            position: relative;
	        }
	        .background-card.locked .unlock-button {
	            pointer-events: auto; /* ãƒœã‚¿ãƒ³ã ã‘ã‚¯ãƒªãƒƒã‚¯å¯èƒ½ã«ã™ã‚‹ */
	            position: relative;
	            z-index: 10; /* å‰é¢ã«å‡ºã™ */
	        }
	    </style>
	</head>

<body class="font-sans">

<div class="main-container"> 
    
    <div class="header-section">
        <h1 class="flex items-center">
            <i class="fa-solid fa-cloud mr-3 text-[var(--primary-color)] text-4xl"></i> 
            èƒŒæ™¯ä¸€è¦§
        </h1>
        <p class="sub-heading">ãƒ›ãƒ¼ãƒ ç”»é¢ã®èƒŒæ™¯ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™</p>
    </div>

    <section class="background-section">
        <h2>èƒŒæ™¯é¸æŠ</h2>
        
        <div id="background-list" class="grid grid-cols-2 sm:grid-cols-3 gap-6">

            
			<!-- ğŸ”¥ ç‚ã®ä¸–ç•Œï¼šå¸¸æ™‚è§£æ”¾ -->
			<div id="card-fire" class="background-card" data-bg="fire-original" data-unlock="0">
			    <div class="card-image-container aspect-video">
			        <img th:src="@{/img/background/fire-original.png}" alt="ç‚ã®ä¸–ç•Œ" class="w-full h-full object-cover cursor-pointer">
			        <div class="card-name-overlay">ç‚ã®ä¸–ç•Œ</div>
			    </div>
			    <div class="card-status-area">
			        <button type="button" class="select-button">é¸æŠ</button>
			    </div>
			</div>

			<!-- ğŸ’§ æ°´ã®ä¸–ç•Œï¼šLv40ã§è§£æ”¾ -->
			<div id="card-water" class="background-card locked" data-bg="water-original" data-unlock="40">
			    <div class="card-image-container aspect-video">
			        <img th:src="@{/img/background/water-original.png}" alt="æ°´ã®ä¸–ç•Œ" class="w-full h-full object-cover cursor-pointer">
			        <div class="card-name-overlay">æ°´ã®ä¸–ç•Œ</div>
			        <i class="fa-solid fa-lock lock-icon"></i>
			    </div>
			    <div class="card-status-area">
			        <p class="unlock-text">å¿…è¦ãƒ¬ãƒ™ãƒ«: 40</p>
			    </div>
			</div>

			<!-- ğŸŒ³ æœ¨ã®ä¸–ç•Œï¼šLv70ã§è§£æ”¾ -->
			<div id="card-grass" class="background-card locked" data-bg="grass-original" data-unlock="70">
			    <div class="card-image-container aspect-video">
			        <img th:src="@{/img/background/grass-original.png}" alt="æœ¨ã®ä¸–ç•Œ" class="w-full h-full object-cover cursor-pointer">
			        <div class="card-name-overlay">æœ¨ã®ä¸–ç•Œ</div>
			        <i class="fa-solid fa-lock lock-icon"></i>
			    </div>
			    <div class="card-status-area">
			        <p class="unlock-text">å¿…è¦ãƒ¬ãƒ™ãƒ«: 70</p>
			    </div>
			</div>

			<!-- ğŸŒŸ å…‰ã®ä¸–ç•Œï¼šLv100ã§è§£æ”¾ -->
			<div id="card-cloud-sky" class="background-card locked" data-bg="cloud-sky" data-unlock="100">
			    <div class="card-image-container aspect-video">
			        <img th:src="@{/img/background/light-original.png}" alt="å…‰ã®ä¸–ç•Œ" class="w-full h-full object-cover cursor-pointer">
			        <div class="card-name-overlay">å…‰ã®ä¸–ç•Œ</div>
			        <i class="fa-solid fa-lock lock-icon"></i>
			    </div>
			    <div class="card-status-area">
			        <p class="unlock-text">å¿…è¦ãƒ¬ãƒ™ãƒ«: 100</p>
			    </div>
			</div>

			<!-- ğŸŒ‘ é—‡ã®ä¸–ç•Œï¼šLv130ã§è§£æ”¾ -->
			<div id="card-dark-castle" class="background-card locked" data-bg="dark-castle" data-unlock="130">
			    <div class="card-image-container aspect-video">
			        <img th:src="@{/img/background/dark-original.png}" alt="é—‡ã®ä¸–ç•Œ" class="w-full h-full object-cover cursor-pointer">
			        <div class="card-name-overlay">é—‡ã®ä¸–ç•Œ</div>
			        <i class="fa-solid fa-lock lock-icon"></i>
			    </div>
			    <div class="card-status-area">
			        <p class="unlock-text">å¿…è¦ãƒ¬ãƒ™ãƒ«: 130</p>
			    </div>
			</div>

			<!-- ğŸ« æ•™å®¤ï¼šç´ æå¿…è¦ -->
			<div id="card-classroom" class="background-card locked" data-bg="classroom" data-material="true">
			    <div class="card-image-container aspect-video">
			        <img th:src="@{/img/background/classroom.png}" alt="æ•™å®¤" class="w-full h-full object-cover cursor-pointer">
			        <div class="card-name-overlay">æ•™å®¤</div>
			        <i class="fa-solid fa-lock lock-icon"></i>
			    </div>
			    <div class="card-status-area">
			        <p class="unlock-text">ç´ æãŒ1ã¤å¿…è¦ã§ã™</p>
			    </div>
			</div>

			<!-- ğŸ® ã‚²ãƒ¼ãƒŸãƒ³ã‚°ãƒ«ãƒ¼ãƒ ï¼šç´ æå¿…è¦ -->
			<div id="card-gaming-room" class="background-card locked" data-bg="gaming-room" data-material="true">
			    <div class="card-image-container aspect-video">
			        <img th:src="@{/img/background/gaming-room.png}" alt="ã‚²ãƒ¼ãƒŸãƒ³ã‚°ãƒ«ãƒ¼ãƒ " class="w-full h-full object-cover cursor-pointer">
			        <div class="card-name-overlay">ã‚²ãƒ¼ãƒŸãƒ³ã‚°ãƒ«ãƒ¼ãƒ </div>
			        <i class="fa-solid fa-lock lock-icon"></i>
			    </div>
			    <div class="card-status-area">
			        <p class="unlock-text">ç´ æãŒ1ã¤å¿…è¦ã§ã™</p>
			    </div>
			</div>

			<!-- ğŸŒ² æ·±ã„æ£®ï¼šç´ æå¿…è¦ -->
			<div id="card-deep-forest" class="background-card locked" data-bg="deep-forest" data-material="true">
			    <div class="card-image-container aspect-video">
			        <img th:src="@{/img/background/deep-forest.png}" alt="æ·±ã„æ£®" class="w-full h-full object-cover cursor-pointer">
			        <div class="card-name-overlay">æ·±ã„æ£®</div>
			        <i class="fa-solid fa-lock lock-icon"></i>
			    </div>
			    <div class="card-status-area">
			        <p class="unlock-text">ç´ æãŒ1ã¤å¿…è¦ã§ã™</p>
			    </div>
			</div>

			<!-- ğŸ™ è¡—ä¸¦ã¿ï¼šç´ æå¿…è¦ -->
			<div id="card-town-view" class="background-card locked" data-bg="town-view" data-material="true">
			    <div class="card-image-container aspect-video">
			        <img th:src="@{/img/background/town-view.png}" alt="è¡—ä¸¦ã¿" class="w-full h-full object-cover cursor-pointer">
			        <div class="card-name-overlay">è¡—ä¸¦ã¿</div>
			        <i class="fa-solid fa-lock lock-icon"></i>
			    </div>
			    <div class="card-status-area">
			        <p class="unlock-text">ç´ æãŒ1ã¤å¿…è¦ã§ã™</p>
			    </div>
			</div>

			<!-- ğŸ’» ã‚µãƒ¼ãƒãƒ¼ãƒ«ãƒ¼ãƒ ï¼šç´ æå¿…è¦ -->
			<div id="card-server-room" class="background-card locked" data-bg="server-room" data-material="true">
			    <div class="card-image-container aspect-video">
			        <img th:src="@{/img/background/server-room.png}" alt="ã‚µãƒ¼ãƒãƒ¼ãƒ«ãƒ¼ãƒ " class="w-full h-full object-cover cursor-pointer">
			        <div class="card-name-overlay">ã‚µãƒ¼ãƒãƒ¼ãƒ«ãƒ¼ãƒ </div>
			        <i class="fa-solid fa-lock lock-icon"></i>
			    </div>
			    <div class="card-status-area">
			        <p class="unlock-text">ç´ æãŒ1ã¤å¿…è¦ã§ã™</p>
			    </div>
			</div>

			<!-- â„ï¸ é›ªé“ï¼šç´ æå¿…è¦ -->
			<div id="card-snow-road" class="background-card locked" data-bg="snow-road" data-material="true">
			    <div class="card-image-container aspect-video">
			        <img th:src="@{/img/background/snow-road.png}" alt="é›ªé“" class="w-full h-full object-cover cursor-pointer">
			        <div class="card-name-overlay">é›ªé“</div>
			        <i class="fa-solid fa-lock lock-icon"></i>
			    </div>
			    <div class="card-status-area">
			        <p class="unlock-text">ç´ æãŒ1ã¤å¿…è¦ã§ã™</p>
			    </div>
			</div>

    
			<div class="back-btn-container fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50">
			    <a th:href="@{/characters/menu/CharactersMenu}" 
			       class="button secondary w-full max-w-xl px-10 py-5 text-2xl font-bold rounded-lg 
			              bg-[var(--primary-color)] text-white hover:opacity-90 shadow-lg transition text-center">
			        <i class="fa-solid fa-arrow-left mr-3"></i> ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹
			    </a>
			</div>



			<!-- ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— -->
			<div id="popup" class="hidden fixed inset-0 z-[1000] bg-black/70 flex items-center justify-center p-4">
			    <div class="flex flex-col items-center">
			        <img id="popup-image" src="" alt="èƒŒæ™¯å…¨ä½“" class="max-w-[90vw] max-h-[80vh] rounded shadow-lg">
			        <button id="close-popup" 
			                class="mt-6 px-8 py-3 rounded-lg font-bold text-white 
			                       bg-[var(--primary-color)] hover:opacity-90 
			                       shadow-lg transition" type="button">
			            é–‰ã˜ã‚‹
			        </button>
			    </div>
			</div>

			<!-- è§£æ”¾ç¢ºèªãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— -->
			<div id="unlock-popup" class="hidden fixed inset-0 z-[1000] bg-black/70 flex items-center justify-center p-4">
			  <div class="bg-white rounded-lg shadow-lg p-6 text-center">
			    <p id="unlock-message" class="mb-6 text-lg font-bold"></p>
			    <div class="flex gap-6 justify-center">
			      <button id="confirm-unlock" class="px-6 py-2 bg-[var(--primary-color)] text-white rounded-lg font-bold">ã¯ã„</button>
			      <button id="cancel-unlock" class="px-6 py-2 bg-gray-400 text-white rounded-lg font-bold">ã„ã„ãˆ</button>
			    </div>
			  </div>
			</div>


	<script src="Backgrounds.js" defer></script>
	<script>
	document.addEventListener('DOMContentLoaded', () => {

	    const hasMaterial = true; // ç´ æãŒã‚ã‚‹ã¨ä»®å®š

	    const backgroundList = document.getElementById('background-list');
	    const popup = document.getElementById('popup');
	    const popupImage = document.getElementById('popup-image');
	    const closePopup = document.getElementById('close-popup');

	    // è§£æ”¾ç¢ºèªãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¦ç´ 
	    const unlockPopup = document.getElementById('unlock-popup');
	    const unlockMessage = document.getElementById('unlock-message');
	    const confirmUnlock = document.getElementById('confirm-unlock');
	    const cancelUnlock = document.getElementById('cancel-unlock');

	    let targetUnlockCard = null; // è§£æ”¾å¯¾è±¡ã‚«ãƒ¼ãƒ‰ã‚’ä¿æŒ

	    // ç´ æç³»ã‚«ãƒ¼ãƒ‰ã«ã€Œè§£æ”¾ã€ãƒœã‚¿ãƒ³ã‚’å‡ºã™
	    if (hasMaterial) {
	        document.querySelectorAll('.background-card.locked[data-material="true"]').forEach(card => {
	            const statusArea = card.querySelector('.card-status-area');
	            statusArea.innerHTML = '<button type="button" class="unlock-button">è§£æ”¾</button>';
	        });
	    }

	    // è§£æ”¾ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤º
	    backgroundList.addEventListener('click', (e) => {
	        const unlockBtn = e.target.closest('.unlock-button');
	        if (unlockBtn) {
	            targetUnlockCard = unlockBtn.closest('.background-card');
	            const bgName = targetUnlockCard.querySelector('.card-name-overlay').textContent;
	            unlockMessage.textContent = `${bgName} ã‚’è§£æ”¾ã—ã¾ã™ã‹ï¼Ÿ`;
	            unlockPopup.classList.remove('hidden');
	            return;
	        }
	    });

	    // ã€Œã¯ã„ã€ã‚¯ãƒªãƒƒã‚¯ â†’ è§£æ”¾å‡¦ç†
	    confirmUnlock.addEventListener('click', () => {
	        if (targetUnlockCard) {
	            targetUnlockCard.classList.remove('locked');
	            targetUnlockCard.querySelector('.lock-icon')?.remove();
	            targetUnlockCard.querySelector('.card-status-area').innerHTML =
	                '<button type="button" class="select-button">é¸æŠ</button>';
	        }
	        unlockPopup.classList.add('hidden');
	        targetUnlockCard = null;
	    });

	    // ã€Œã„ã„ãˆã€ã‚¯ãƒªãƒƒã‚¯ â†’ ã‚­ãƒ£ãƒ³ã‚»ãƒ«
	    cancelUnlock.addEventListener('click', () => {
	        unlockPopup.classList.add('hidden');
	        targetUnlockCard = null;
	    });

	    // ç”»åƒã‚¯ãƒªãƒƒã‚¯ã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
	    backgroundList.addEventListener('click', (e) => {
	        const img = e.target.closest('.card-image-container img');
	        if (img) {
	            popupImage.src = img.src;
	            popup.classList.remove('hidden');
	        }
	    });

	    // é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
	    closePopup.addEventListener('click', () => {
	        popup.classList.add('hidden');
	        popupImage.src = '';
	    });

	    // èƒŒæ™¯ã‚¯ãƒªãƒƒã‚¯ã§ã‚‚é–‰ã˜ã‚‹
	    popup.addEventListener('click', (e) => {
	        if (e.target === popup) {
	            popup.classList.add('hidden');
	            popupImage.src = '';
	        }
	    });

	    // é¸æŠãƒœã‚¿ãƒ³ã§èƒŒæ™¯é©ç”¨ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆå§”è­²ï¼‰
	    backgroundList.addEventListener('click', (e) => {
	        const selectBtn = e.target.closest('.select-button');
	        if (!selectBtn) return;

	        e.preventDefault();

	        // âœ… é¸æŠã—ãŸã‚«ãƒ¼ãƒ‰ã‚’å–å¾—
	        const targetCard = selectBtn.closest('.background-card');

			// å…¨ã‚«ãƒ¼ãƒ‰ã®é¸æŠè§£é™¤ï¼†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ
			document.querySelectorAll('.background-card').forEach(card => {
			    card.classList.remove('selected');
			    const statusArea = card.querySelector('.card-status-area');
			    if (!statusArea) return;

			    const unlockLevel = parseInt(card.dataset.unlock || 0, 10);
			    const needsMaterial = card.dataset.material === "true";

			    if (card.classList.contains('locked')) {
			        if (unlockLevel > 0) {
			            statusArea.innerHTML = `<p class="unlock-text">å¿…è¦ãƒ¬ãƒ™ãƒ«: ${unlockLevel}</p>`;
			        } else if (needsMaterial) {
			            // âœ… ç´ æãŒã‚ã‚‹ã¨ãã¯è§£æ”¾ãƒœã‚¿ãƒ³ã€ãªã„ã¨ãã¯è§£æ”¾æ–‡å­—
			            if (hasMaterial) {
			                statusArea.innerHTML = '<button type="button" class="unlock-button">è§£æ”¾</button>';
			            } else {
			                statusArea.innerHTML = '<p class="unlock-text">ç´ æãŒ1ã¤å¿…è¦ã§ã™</p>';
			            }
			        } else {
			            statusArea.innerHTML = '<p class="unlock-text">ãƒ­ãƒƒã‚¯</p>';
			        }
			    } else {
			        statusArea.innerHTML = '<button type="button" class="select-button">é¸æŠ</button>';
			    }
			});

			// âœ… å¯¾è±¡ã‚«ãƒ¼ãƒ‰ã‚’é©ç”¨ä¸­ã«å¤‰æ›´
			targetCard.classList.add('selected');
			const targetStatus = targetCard.querySelector('.card-status-area');
			if (targetStatus) {
			    targetStatus.innerHTML = '<p class="status-text">é©ç”¨ä¸­</p>';
			}
			});

			// ã“ã“ã§å®Ÿéš›ã®èƒŒæ™¯é©ç”¨å‡¦ç†ãŒå¿…è¦ãªã‚‰ã€ãƒ‡ãƒ¼ã‚¿å±æ€§ã§è­˜åˆ¥ã—ã¦åæ˜ ï¼ˆä¾‹ï¼‰
			// const bgKey = targetCard.dataset.bg;
			// applyBackground(bgKey); // ä¾‹ãˆã°ãƒšãƒ¼ã‚¸èƒŒæ™¯ã®åˆ‡ã‚Šæ›¿ãˆãªã©
			});

	</script>



</div>
</body>
</html>
