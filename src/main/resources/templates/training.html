<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <title>トレーニング選択</title>
    <link rel="stylesheet" th:href="@{/css/base.css}">
    <link rel="stylesheet" th:href="@{/css/home.css}">
    
    <style>
        /* トレーニング選択画面固有のスタイル (必要に応じて) */
        .card { 
            margin-bottom: 25px; 
            padding: 20px; 
            border: 1px solid #e0e0e0; 
            border-radius: 8px; 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            background-color: #ffffff;
        }
    </style>
</head>
<body>

<div class="container main-content">
    <h1 class="page-title">🏋️ トレーニングメニュー選択</h1>
    
    <div th:if="${param.logout}" class="alert alert-success">ログアウトしました。</div>

    <div class="card training-option">
        <form th:action="@{/training/start}" method="post">
            <input type="hidden" name="type" value="ai-suggested"/>
            <input type="hidden" name="exerciseName" value="AIおすすめプログラム"/>
            <h2 class="card-title">AIおすすめメニュー</h2>
            <p class="text-secondary">AIが目標や過去の履歴に基づいた最適なトレーニングプログラムを提案します。</p>
            <button type="submit" class="button primary mt-3">セッション開始 <i class="fa-solid fa-robot"></i></button>
        </form>
    </div>

    <div class="card training-option" id="free-weight-option">
        <form th:action="@{/training/start}" method="post">
            <input type="hidden" name="type" value="free-weight"/>
            <h2 class="card-title">フリーウェイト</h2>
            
            <div class="form-group">
                <label for="musclePart">鍛えたい部位:</label>
                <select id="musclePart" class="form-control" required>
                    <option value="">部位を選択してください</option>
                    <option th:each="part : ${freeWeightParts}" th:value="${part}" th:text="${part}"></option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="exerciseName">種目名:</label>
                <select id="exerciseName" name="exerciseName" class="form-control" required disabled>
                    <option value="">部位を選択してから種目を選んでください</option>
                </select>
            </div>
            
            <button type="submit" class="button primary mt-3" id="startFreeWeightSessionButton" disabled>セッション開始 <i class="fa-solid fa-dumbbell"></i></button>
        </form>
    </div>
    <div class="card training-option">
        <form th:action="@{/training/start}" method="post">
            <input type="hidden" name="type" value="cardio"/>
            <h2 class="card-title">有酸素運動</h2>
            
            <div class="form-group">
                <label for="cardioExerciseName">種目名:</label>
                <select id="cardioExerciseName" name="exerciseName" class="form-control" required>
                    <option value="">種目を選択してください</option>
                    <option th:each="exercise : ${cardioExercises}" th:value="${exercise}" th:text="${exercise}"></option>
                </select>
            </div>
            
            <button type="submit" class="button primary mt-3">セッション開始 <i class="fa-solid fa-running"></i></button>
        </form>
    </div>
    
    <script th:inline="javascript">
        /*<![CDATA[*/
        const freeWeightExercisesByPart = /*[[${freeWeightExercisesByPart}]]*/ {};
        
        document.addEventListener('DOMContentLoaded', function() {
            const musclePartSelect = document.getElementById('musclePart');
            const exerciseNameSelect = document.getElementById('exerciseName');
            const startFreeWeightSessionButton = document.getElementById('startFreeWeightSessionButton');
            
            if (musclePartSelect && exerciseNameSelect) {
                
                musclePartSelect.addEventListener('change', function() {
                    const selectedPart = this.value;
                    
                    exerciseNameSelect.innerHTML = '<option value="">種目を選択してください</option>';
                    exerciseNameSelect.disabled = true;
                    startFreeWeightSessionButton.disabled = true;

                    if (selectedPart && freeWeightExercisesByPart[selectedPart]) {
                        const exercises = freeWeightExercisesByPart[selectedPart];
                        
                        exercises.forEach(exercise => {
                            const option = document.createElement('option');
                            option.value = exercise;
                            option.textContent = exercise;
                            exerciseNameSelect.appendChild(option);
                        });
                        exerciseNameSelect.disabled = false;
                    } else {
                        exerciseNameSelect.innerHTML = '<option value="">部位を選択してから種目を選んでください</option>';
                    }
                });
                
                exerciseNameSelect.addEventListener('change', function() {
                    startFreeWeightSessionButton.disabled = !this.value;
                });
            }
        });
        /*]]>*/
    </script>
    
</div>

</body>
</html>

